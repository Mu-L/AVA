{"componentChunkName":"component---node-modules-antv-gatsby-theme-antv-site-templates-example-tsx","path":"/en/examples/chart-linter/linter/API","result":{"data":{"site":{"siteMetadata":{"title":"AVA","galleryMenuCloseAll":false,"examples":[{"slug":"ckb","icon":null,"title":{"zh":"图表知识库（CKB)","en":"Chart Knowledge Base (CKB)"}},{"slug":"chart-advisor","icon":null,"title":{"zh":"图表推荐库","en":"ChartAdvisor"}},{"slug":"chart-linter","icon":null,"title":{"zh":"图表优化","en":"ChartLinter"}},{"slug":"others","icon":null,"title":{"zh":"其他","en":"Others"}}],"playground":{"container":null,"playgroundDidMount":null,"playgroundWillUnmount":null,"dependencies":null,"devDependencies":null,"htmlCodeTemplate":null}},"pathPrefix":""},"allMarkdownRemark":{"edges":[{"node":{"fields":{"slug":"/zh/examples/gallery"},"frontmatter":{"title":"所有图表","order":-1,"icon":"other"},"parent":{"__typename":"File","relativePath":"gallery/index.zh.md"}}},{"node":{"fields":{"slug":"/en/examples/gallery"},"frontmatter":{"title":"Gallery","order":-1,"icon":"other"},"parent":{"__typename":"File","relativePath":"gallery/index.en.md"}}},{"node":{"fields":{"slug":"/zh/examples/others/thumbnails"},"frontmatter":{"title":"Thumbnails 缩略图","order":0,"icon":null},"parent":{"__typename":"File","relativePath":"others/thumbnails/index.zh.md"}}},{"node":{"fields":{"slug":"/en/examples/others/thumbnails"},"frontmatter":{"title":"Thumbnails","order":0,"icon":null},"parent":{"__typename":"File","relativePath":"others/thumbnails/index.en.md"}}},{"node":{"fields":{"slug":"/en/examples/ckb/CKBJson"},"frontmatter":{"title":"CKB Application","order":0,"icon":null},"parent":{"__typename":"File","relativePath":"ckb/CKBJson/index.en.md"}}},{"node":{"fields":{"slug":"/zh/examples/ckb/CKBJson"},"frontmatter":{"title":"CKB 的应用","order":0,"icon":null},"parent":{"__typename":"File","relativePath":"ckb/CKBJson/index.zh.md"}}},{"node":{"fields":{"slug":"/zh/examples/chart-linter/linter"},"frontmatter":{"title":"ChartLinter 示例","order":0,"icon":null},"parent":{"__typename":"File","relativePath":"chart-linter/linter/index.zh.md"}}},{"node":{"fields":{"slug":"/en/examples/chart-linter/linter"},"frontmatter":{"title":"ChartLinter","order":0,"icon":null},"parent":{"__typename":"File","relativePath":"chart-linter/linter/index.en.md"}}},{"node":{"fields":{"slug":"/zh/examples/chart-advisor/auto-chart"},"frontmatter":{"title":"autoChart 示例","order":0,"icon":null},"parent":{"__typename":"File","relativePath":"chart-advisor/auto-chart/index.zh.md"}}},{"node":{"fields":{"slug":"/en/examples/chart-advisor/auto-chart"},"frontmatter":{"title":"autoChart","order":0,"icon":null},"parent":{"__typename":"File","relativePath":"chart-advisor/auto-chart/index.en.md"}}},{"node":{"fields":{"slug":"/zh/examples/chart-advisor/pipeline"},"frontmatter":{"title":"pipeline 流程","order":1,"icon":null},"parent":{"__typename":"File","relativePath":"chart-advisor/pipeline/index.zh.md"}}},{"node":{"fields":{"slug":"/en/examples/chart-advisor/pipeline"},"frontmatter":{"title":"pipeline","order":1,"icon":null},"parent":{"__typename":"File","relativePath":"chart-advisor/pipeline/index.en.md"}}},{"node":{"fields":{"slug":"/zh/examples/others/thumbnails/API"},"frontmatter":{"title":"","order":null,"icon":null},"parent":{"__typename":"File","relativePath":"others/thumbnails/API.zh.md"}}},{"node":{"fields":{"slug":"/en/examples/others/thumbnails/API"},"frontmatter":{"title":"","order":null,"icon":null},"parent":{"__typename":"File","relativePath":"others/thumbnails/API.en.md"}}},{"node":{"fields":{"slug":"/zh/examples/ckb/CKBJson/API"},"frontmatter":{"title":"","order":null,"icon":null},"parent":{"__typename":"File","relativePath":"ckb/CKBJson/API.zh.md"}}},{"node":{"fields":{"slug":"/en/examples/chart-linter/linter/API"},"frontmatter":{"title":"","order":null,"icon":null},"parent":{"__typename":"File","relativePath":"chart-linter/linter/API.en.md"}}},{"node":{"fields":{"slug":"/en/examples/ckb/CKBJson/API"},"frontmatter":{"title":"","order":null,"icon":null},"parent":{"__typename":"File","relativePath":"ckb/CKBJson/API.en.md"}}},{"node":{"fields":{"slug":"/zh/examples/chart-linter/linter/API"},"frontmatter":{"title":"","order":null,"icon":null},"parent":{"__typename":"File","relativePath":"chart-linter/linter/API.zh.md"}}},{"node":{"fields":{"slug":"/en/examples/chart-advisor/pipeline/API"},"frontmatter":{"title":"","order":null,"icon":null},"parent":{"__typename":"File","relativePath":"chart-advisor/pipeline/API.en.md"}}},{"node":{"fields":{"slug":"/zh/examples/chart-advisor/pipeline/API"},"frontmatter":{"title":"","order":null,"icon":null},"parent":{"__typename":"File","relativePath":"chart-advisor/pipeline/API.zh.md"}}},{"node":{"fields":{"slug":"/zh/examples/chart-advisor/auto-chart/API"},"frontmatter":{"title":"","order":null,"icon":null},"parent":{"__typename":"File","relativePath":"chart-advisor/auto-chart/API.zh.md"}}},{"node":{"fields":{"slug":"/en/examples/chart-advisor/auto-chart/API"},"frontmatter":{"title":"","order":null,"icon":null},"parent":{"__typename":"File","relativePath":"chart-advisor/auto-chart/API.en.md"}}}]}},"pageContext":{"allDemos":[{"relativePath":"others/thumbnails/demo/all.jsx","absolutePath":"/Users/pd/Documents/code/github/AVA/packages/ava-site/examples/others/thumbnails/demo/all.jsx","order":1,"filename":"all.jsx","title":{"en":"View All Thumbnails","zh":"Thumbnails 缩略图一览"},"screenshot":"https://gw.alipayobjects.com/zos/antfincdn/YQGTC0Zq%26t/thumbnails-viewall.gif","postFrontmatter":{"zh":{"title":"Thumbnails 缩略图","order":400},"en":{"title":"Thumbnails","order":400}}},{"relativePath":"others/thumbnails/demo/usage.jsx","absolutePath":"/Users/pd/Documents/code/github/AVA/packages/ava-site/examples/others/thumbnails/demo/usage.jsx","order":0,"filename":"usage.jsx","title":{"en":"Thumbnails Usage","zh":"Thumbnails 缩略图用法"},"screenshot":"https://gw.alipayobjects.com/zos/antfincdn/ObPIQYzZJU/thumbnails-usage.png","postFrontmatter":{"zh":{"title":"Thumbnails 缩略图","order":400},"en":{"title":"Thumbnails","order":400}}},{"relativePath":"others/thumbnails/demo/select.jsx","absolutePath":"/Users/pd/Documents/code/github/AVA/packages/ava-site/examples/others/thumbnails/demo/select.jsx","order":2,"filename":"select.jsx","title":{"en":"Select Chart by Thumbnails","zh":"通过缩略图选择图表"},"screenshot":"https://gw.alipayobjects.com/zos/antfincdn/zwo0GDlia6/thumbnails-select.gif","postFrontmatter":{"zh":{"title":"Thumbnails 缩略图","order":400},"en":{"title":"Thumbnails","order":400}}},{"relativePath":"ckb/CKBJson/demo/chartdic.jsx","absolutePath":"/Users/pd/Documents/code/github/AVA/packages/ava-site/examples/ckb/CKBJson/demo/chartdic.jsx","order":0,"filename":"chartdic.jsx","title":{"zh":"使用 CKB 制作图表词典","en":"Chart Dictionary by CKB"},"screenshot":"https://gw.alipayobjects.com/mdn/rms_fabca5/afts/img/A*TOjFQ6PQwyEAAAAAAAAAAAAAARQnAQ","postFrontmatter":{"en":{"title":"CKB Application","order":100},"zh":{"title":"CKB 的应用","order":100}}},{"relativePath":"chart-linter/linter/demo/g2plot.jsx","absolutePath":"/Users/pd/Documents/code/github/AVA/packages/ava-site/examples/chart-linter/linter/demo/g2plot.jsx","order":1,"filename":"g2plot.jsx","title":{"en":"Using in G2Plot","zh":"在G2Plot中使用"},"screenshot":"https://gw.alipayobjects.com/zos/antfincdn/dNEGhttBFB/Kapture%2525202021-05-26%252520at%25252023.29.22.gif","new":true,"postFrontmatter":{"zh":{"title":"ChartLinter 示例","order":300},"en":{"title":"ChartLinter","order":300}}},{"relativePath":"chart-linter/linter/demo/pipeline.jsx","absolutePath":"/Users/pd/Documents/code/github/AVA/packages/ava-site/examples/chart-linter/linter/demo/pipeline.jsx","order":0,"filename":"pipeline.jsx","title":{"en":"Linter and Fixer","zh":"Linter和Fixer全流程"},"screenshot":"https://gw.alipayobjects.com/zos/antfincdn/mW18m%26G0hi/Kapture%2525202021-05-27%252520at%25252020.14.24.gif","new":true,"postFrontmatter":{"zh":{"title":"ChartLinter 示例","order":300},"en":{"title":"ChartLinter","order":300}}},{"relativePath":"chart-advisor/pipeline/demo/basic.jsx","absolutePath":"/Users/pd/Documents/code/github/AVA/packages/ava-site/examples/chart-advisor/pipeline/demo/basic.jsx","order":0,"filename":"basic.jsx","title":{"en":"pipeline demo","zh":"pipeline demo"},"screenshot":"https://gw.alipayobjects.com/mdn/rms_fabca5/afts/img/A*cj1_Sr45sAoAAAAAAAAAAAAAARQnAQ","postFrontmatter":{"zh":{"title":"pipeline 流程","order":201},"en":{"title":"pipeline","order":201}}},{"relativePath":"chart-advisor/auto-chart/demo/basic.ts","absolutePath":"/Users/pd/Documents/code/github/AVA/packages/ava-site/examples/chart-advisor/auto-chart/demo/basic.ts","order":0,"filename":"basic.ts","title":{"en":"Basic autoChart usage","zh":"基础 autoChart 用法"},"screenshot":"https://gw.alipayobjects.com/mdn/rms_fabca5/afts/img/A*hbeeS6gtKVQAAAAAAAAAAAAAARQnAQ","postFrontmatter":{"zh":{"title":"autoChart 示例","order":200},"en":{"title":"autoChart","order":200}}},{"relativePath":"chart-advisor/auto-chart/demo/refine.ts","absolutePath":"/Users/pd/Documents/code/github/AVA/packages/ava-site/examples/chart-advisor/auto-chart/demo/refine.ts","order":1,"filename":"refine.ts","title":{"en":"Refine Chart","zh":"开启图表细节优化"},"screenshot":"https://gw.alipayobjects.com/mdn/rms_fabca5/afts/img/A*ybCXT4O_DXwAAAAAAAAAAAAAARQnAQ","postFrontmatter":{"zh":{"title":"autoChart 示例","order":200},"en":{"title":"autoChart","order":200}}},{"relativePath":"chart-advisor/auto-chart/demo/custom-rules.jsx","absolutePath":"/Users/pd/Documents/code/github/AVA/packages/ava-site/examples/chart-advisor/auto-chart/demo/custom-rules.jsx","order":2,"filename":"custom-rules.jsx","title":{"en":"Customized Rules","zh":"自定义推荐规则"},"screenshot":"https://gw.alipayobjects.com/zos/antfincdn/QNOIESEqnK/customrules.png","postFrontmatter":{"zh":{"title":"autoChart 示例","order":200},"en":{"title":"autoChart","order":200}}}],"exampleSections":{"examples":[{"relativePath":"chart-linter/linter/demo/pipeline.jsx","absolutePath":"/Users/pd/Documents/code/github/AVA/packages/ava-site/examples/chart-linter/linter/demo/pipeline.jsx","order":0,"filename":"pipeline.jsx","title":{"en":"Linter and Fixer","zh":"Linter和Fixer全流程"},"screenshot":"https://gw.alipayobjects.com/zos/antfincdn/mW18m%26G0hi/Kapture%2525202021-05-27%252520at%25252020.14.24.gif","new":true,"source":"import React, { useState, useEffect } from 'react';\nimport ReactDOM from 'react-dom';\nimport { Button, Menu, Dropdown, Empty } from 'antd';\nimport { BarChartOutlined } from '@ant-design/icons';\nimport { VegaLite } from 'react-vega';\nimport { getFieldsFromData, vl2asp, Linter, fixer } from '@antv/chart-linter';\n\nconst EXAMPLES = [\n    {\n        name: 'badsize',\n        spec: {\n            mark: 'point',\n            encoding: {\n                x: {\n                    field: 'Horsepower',\n                    type: 'quantitative',\n                },\n                y: {\n                    field: 'Miles_per_Gallon',\n                    type: 'quantitative',\n                },\n                size: {\n                    field: 'Origin',\n                    type: 'nominal',\n                },\n            },\n            data: {\n                url: 'https://gw.alipayobjects.com/os/antfincdn/%24JXRLVNQw0/cars.json',\n            },\n        },\n    },\n    {\n        name: 'badx',\n        spec: {\n            mark: 'bar',\n            encoding: {\n                x: {\n                    field: 'Acceleration',\n                    type: 'quantitative',\n                },\n                y: {\n                    field: 'Horsepower',\n                    type: 'quantitative',\n                },\n            },\n            data: {\n                url: 'https://gw.alipayobjects.com/os/antfincdn/%24JXRLVNQw0/cars.json',\n            },\n        },\n    },\n    {\n        name: 'badlogzero',\n        spec: {\n            mark: 'bar',\n            encoding: {\n                x: {\n                    field: 'Acceleration',\n                    type: 'quantitative',\n                },\n                y: {\n                    field: 'Horsepower',\n                    type: 'quantitative',\n                    scale: {\n                        zero: true,\n                        type: 'log',\n                    },\n                },\n            },\n            data: {\n                url: 'https://gw.alipayobjects.com/os/antfincdn/%24JXRLVNQw0/cars.json',\n            },\n        },\n    },\n];\n\nconst ChartVl = (props) => {\n    const { spec, data } = props;\n    return (\n        <div>\n            <VegaLite spec={spec} data={data} />\n        </div>\n    );\n};\n\nconst prettyJSON = json => {\n    return JSON.stringify(\n        json,\n        function (_, v) {\n            for (const p in v) {\n                if (v[p] instanceof Object) {\n                    return v;\n                }\n            }\n            return JSON.stringify(v, null, 1);\n        },\n        2\n    )\n        .replace(/\\\\n/g, '')\n        .replace(/\\\\/g, '')\n        .replace(/\"\\[/g, '[')\n        .replace(/\\]\"/g, ']')\n        .replace(/\"\\{/g, '{')\n        .replace(/\\}\"/g, ' }');\n};\n\nconst ChartCodeWrapper = (props) => {\n    const { spec } = props;\n\n    return (\n        <div style={{ display: 'flex' }}>\n            <div>{spec.mark ? <ChartVl spec={spec} /> : <Empty description=\"empty spec\" />}</div>\n            <div>\n                <textarea\n                    style={{ width: 360, height: 240, marginLeft: 16, resize: 'none', wordWrap: 'break-word', overflowY: 'scroll' }}\n                    value={spec.mark ? prettyJSON(spec) : ''}\n                    readOnly\n                />\n            </div>\n        </div>\n    );\n};\n\nconst LinterWrapper = (props) => {\n    const { solverInit, aspStr, toSolve, violatedRules } = props;\n\n    return (\n        <div>\n            <div style={{ marginBottom: 32 }}>\n                <Button\n                    type=\"primary\"\n                    disabled={!solverInit || !aspStr}\n                    onClick={() => {\n                        toSolve();\n                    }}\n                >\n                    Solve\n                </Button>\n                <span style={{ marginLeft: 16 }}>\n                    {solverInit ? 'solver ready.' : 'solver initing...'}\n                </span>\n            </div>\n            <textarea\n                style={{ width: 460, height: 100, marginLeft: 16, resize: 'none', wordWrap: 'break-word', overflowY: 'scroll' }}\n                value={violatedRules && violatedRules.length ? prettyJSON(violatedRules) : ''}\n                readOnly\n            />\n        </div>\n    );\n};\n\nconst App = () => {\n    const [linter, setLinter] = useState();\n    const [solverInit, setSolverInit] = useState(false);\n    const [exampleIndex, setExampleIndex] = useState(0);\n    const [aspStr, setAspStr] = useState('');\n    const [violatedRules, setViolatedRules] = useState([]);\n    const [optVl, setOptVl] = useState({});\n    const [fixing, setFixing] = useState(false);\n    const [fieldInfos, setFieldInfos] = useState([]);\n\n    const pickViolatedRuleArray = violatedRules[0];\n    const example = EXAMPLES[exampleIndex];\n\n    useEffect(() => {\n        const linter = new Linter();\n\n        linter.init().then(() => {\n            setLinter(linter);\n            setSolverInit(true);\n        });\n    }, []);\n\n    useEffect(() => {\n        const transformVltoAsp = async spec => {\n            const newFieldInfos = await getFieldsFromData(spec);\n            setFieldInfos(newFieldInfos);\n            const newAspStr = example.spec && vl2asp(spec, newFieldInfos).join('\\n');\n            setAspStr(newAspStr);\n        }\n        transformVltoAsp(example.spec);\n    }, [exampleIndex]);\n\n    const reset = () => {\n        setAspStr('');\n        setViolatedRules([]);\n        setOptVl({});\n        setFixing(false);\n        setFieldInfos([]);\n    }\n\n    const toSolve = program => {\n        const { rules } = linter.solve(program, { models: 5 });\n        setViolatedRules(rules);\n    }\n\n    const toFix = async (spec, rules) => {\n        setFixing(true);\n        const { optimizedVL } = await fixer(spec, rules, fieldInfos);\n        setOptVl(optimizedVL);\n        setFixing(false);\n    }\n\n    const menu = (\n        <Menu\n            onClick={({ key }) => {\n                reset();\n                setExampleIndex(key);\n            }}\n        >\n            {EXAMPLES.map((example, index) => (\n                <Menu.Item key={index} icon={<BarChartOutlined />}>\n                    {example.name}\n                </Menu.Item>\n            ))}\n        </Menu>\n    );\n\n    return (\n        <div>\n            <h3>Scroll to view all</h3>\n\n            <Dropdown.Button overlay={menu}>{example.name}</Dropdown.Button>\n            <ChartCodeWrapper spec={example.spec} />\n\n            <LinterWrapper\n                solverInit={solverInit}\n                aspStr={aspStr}\n                toSolve={() => {\n                    toSolve(aspStr);\n                }}\n                violatedRules={violatedRules}\n            />\n\n            <div style={{ marginTop: 32 }}>\n                <Button\n                    type=\"primary\"\n                    disabled={!violatedRules || !violatedRules.length}\n                    onClick={async () => {\n                        await toFix(example.spec, pickViolatedRuleArray);\n                    }}\n                >\n                    Fix\n                </Button>\n                <span style={{ marginLeft: 16 }}>\n                    {violatedRules && violatedRules.length && optVl.mark ? 'Done.' : fixing ? 'Fixing...' : ''}\n                </span>\n            </div>\n\n            <ChartCodeWrapper spec={optVl} />\n        </div>\n    );\n}\n\nReactDOM.render(<App />, document.getElementById('container'));\n","babeledSource":"function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n(function (global, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    define([\"react\", \"react-dom\", \"antd\", \"@ant-design/icons\", \"react-vega\", \"@antv/chart-linter\"], factory);\n  } else if (typeof exports !== \"undefined\") {\n    factory(require(\"react\"), require(\"react-dom\"), require(\"antd\"), require(\"@ant-design/icons\"), require(\"react-vega\"), require(\"@antv/chart-linter\"));\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(global.react, global.reactDom, global.antd, global.icons, global.reactVega, global.chartLinter);\n    global.pipeline = mod.exports;\n  }\n})(typeof globalThis !== \"undefined\" ? globalThis : typeof self !== \"undefined\" ? self : this, function (_react, _reactDom, _antd, _icons, _reactVega, _chartLinter) {\n  \"use strict\";\n\n  _react = _interopRequireWildcard(_react);\n  _reactDom = _interopRequireDefault(_reactDom);\n\n  function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n  function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\n  function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\n  function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\n  function _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\n  function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\n  function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n  function _iterableToArrayLimit(arr, i) { var _i = arr && (typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]); if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\n  function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\n  function _instanceof(left, right) { if (right != null && typeof Symbol !== \"undefined\" && right[Symbol.hasInstance]) { return !!right[Symbol.hasInstance](left); } else { return left instanceof right; } }\n\n  var EXAMPLES = [{\n    name: 'badsize',\n    spec: {\n      mark: 'point',\n      encoding: {\n        x: {\n          field: 'Horsepower',\n          type: 'quantitative'\n        },\n        y: {\n          field: 'Miles_per_Gallon',\n          type: 'quantitative'\n        },\n        size: {\n          field: 'Origin',\n          type: 'nominal'\n        }\n      },\n      data: {\n        url: 'https://gw.alipayobjects.com/os/antfincdn/%24JXRLVNQw0/cars.json'\n      }\n    }\n  }, {\n    name: 'badx',\n    spec: {\n      mark: 'bar',\n      encoding: {\n        x: {\n          field: 'Acceleration',\n          type: 'quantitative'\n        },\n        y: {\n          field: 'Horsepower',\n          type: 'quantitative'\n        }\n      },\n      data: {\n        url: 'https://gw.alipayobjects.com/os/antfincdn/%24JXRLVNQw0/cars.json'\n      }\n    }\n  }, {\n    name: 'badlogzero',\n    spec: {\n      mark: 'bar',\n      encoding: {\n        x: {\n          field: 'Acceleration',\n          type: 'quantitative'\n        },\n        y: {\n          field: 'Horsepower',\n          type: 'quantitative',\n          scale: {\n            zero: true,\n            type: 'log'\n          }\n        }\n      },\n      data: {\n        url: 'https://gw.alipayobjects.com/os/antfincdn/%24JXRLVNQw0/cars.json'\n      }\n    }\n  }];\n\n  var ChartVl = function ChartVl(props) {\n    var spec = props.spec,\n        data = props.data;\n    return /*#__PURE__*/_react.default.createElement(\"div\", null, /*#__PURE__*/_react.default.createElement(_reactVega.VegaLite, {\n      spec: spec,\n      data: data\n    }));\n  };\n\n  var prettyJSON = function prettyJSON(json) {\n    return JSON.stringify(json, function (_, v) {\n      for (var p in v) {\n        if (_instanceof(v[p], Object)) {\n          return v;\n        }\n      }\n\n      return JSON.stringify(v, null, 1);\n    }, 2).replace(/\\\\n/g, '').replace(/\\\\/g, '').replace(/\"\\[/g, '[').replace(/\\]\"/g, ']').replace(/\"\\{/g, '{').replace(/\\}\"/g, ' }');\n  };\n\n  var ChartCodeWrapper = function ChartCodeWrapper(props) {\n    var spec = props.spec;\n    return /*#__PURE__*/_react.default.createElement(\"div\", {\n      style: {\n        display: 'flex'\n      }\n    }, /*#__PURE__*/_react.default.createElement(\"div\", null, spec.mark ? /*#__PURE__*/_react.default.createElement(ChartVl, {\n      spec: spec\n    }) : /*#__PURE__*/_react.default.createElement(_antd.Empty, {\n      description: \"empty spec\"\n    })), /*#__PURE__*/_react.default.createElement(\"div\", null, /*#__PURE__*/_react.default.createElement(\"textarea\", {\n      style: {\n        width: 360,\n        height: 240,\n        marginLeft: 16,\n        resize: 'none',\n        wordWrap: 'break-word',\n        overflowY: 'scroll'\n      },\n      value: spec.mark ? prettyJSON(spec) : '',\n      readOnly: true\n    })));\n  };\n\n  var LinterWrapper = function LinterWrapper(props) {\n    var solverInit = props.solverInit,\n        aspStr = props.aspStr,\n        toSolve = props.toSolve,\n        violatedRules = props.violatedRules;\n    return /*#__PURE__*/_react.default.createElement(\"div\", null, /*#__PURE__*/_react.default.createElement(\"div\", {\n      style: {\n        marginBottom: 32\n      }\n    }, /*#__PURE__*/_react.default.createElement(_antd.Button, {\n      type: \"primary\",\n      disabled: !solverInit || !aspStr,\n      onClick: function onClick() {\n        toSolve();\n      }\n    }, \"Solve\"), /*#__PURE__*/_react.default.createElement(\"span\", {\n      style: {\n        marginLeft: 16\n      }\n    }, solverInit ? 'solver ready.' : 'solver initing...')), /*#__PURE__*/_react.default.createElement(\"textarea\", {\n      style: {\n        width: 460,\n        height: 100,\n        marginLeft: 16,\n        resize: 'none',\n        wordWrap: 'break-word',\n        overflowY: 'scroll'\n      },\n      value: violatedRules && violatedRules.length ? prettyJSON(violatedRules) : '',\n      readOnly: true\n    }));\n  };\n\n  var App = function App() {\n    var _useState = (0, _react.useState)(),\n        _useState2 = _slicedToArray(_useState, 2),\n        linter = _useState2[0],\n        setLinter = _useState2[1];\n\n    var _useState3 = (0, _react.useState)(false),\n        _useState4 = _slicedToArray(_useState3, 2),\n        solverInit = _useState4[0],\n        setSolverInit = _useState4[1];\n\n    var _useState5 = (0, _react.useState)(0),\n        _useState6 = _slicedToArray(_useState5, 2),\n        exampleIndex = _useState6[0],\n        setExampleIndex = _useState6[1];\n\n    var _useState7 = (0, _react.useState)(''),\n        _useState8 = _slicedToArray(_useState7, 2),\n        aspStr = _useState8[0],\n        setAspStr = _useState8[1];\n\n    var _useState9 = (0, _react.useState)([]),\n        _useState10 = _slicedToArray(_useState9, 2),\n        violatedRules = _useState10[0],\n        setViolatedRules = _useState10[1];\n\n    var _useState11 = (0, _react.useState)({}),\n        _useState12 = _slicedToArray(_useState11, 2),\n        optVl = _useState12[0],\n        setOptVl = _useState12[1];\n\n    var _useState13 = (0, _react.useState)(false),\n        _useState14 = _slicedToArray(_useState13, 2),\n        fixing = _useState14[0],\n        setFixing = _useState14[1];\n\n    var _useState15 = (0, _react.useState)([]),\n        _useState16 = _slicedToArray(_useState15, 2),\n        fieldInfos = _useState16[0],\n        setFieldInfos = _useState16[1];\n\n    var pickViolatedRuleArray = violatedRules[0];\n    var example = EXAMPLES[exampleIndex];\n    (0, _react.useEffect)(function () {\n      var linter = new _chartLinter.Linter();\n      linter.init().then(function () {\n        setLinter(linter);\n        setSolverInit(true);\n      });\n    }, []);\n    (0, _react.useEffect)(function () {\n      var transformVltoAsp = async function transformVltoAsp(spec) {\n        var newFieldInfos = await (0, _chartLinter.getFieldsFromData)(spec);\n        setFieldInfos(newFieldInfos);\n        var newAspStr = example.spec && (0, _chartLinter.vl2asp)(spec, newFieldInfos).join('\\n');\n        setAspStr(newAspStr);\n      };\n\n      transformVltoAsp(example.spec);\n    }, [exampleIndex]);\n\n    var reset = function reset() {\n      setAspStr('');\n      setViolatedRules([]);\n      setOptVl({});\n      setFixing(false);\n      setFieldInfos([]);\n    };\n\n    var _toSolve = function toSolve(program) {\n      var _linter$solve = linter.solve(program, {\n        models: 5\n      }),\n          rules = _linter$solve.rules;\n\n      setViolatedRules(rules);\n    };\n\n    var toFix = async function toFix(spec, rules) {\n      setFixing(true);\n\n      var _await$fixer = await (0, _chartLinter.fixer)(spec, rules, fieldInfos),\n          optimizedVL = _await$fixer.optimizedVL;\n\n      setOptVl(optimizedVL);\n      setFixing(false);\n    };\n\n    var menu = /*#__PURE__*/_react.default.createElement(_antd.Menu, {\n      onClick: function onClick(_ref) {\n        var key = _ref.key;\n        reset();\n        setExampleIndex(key);\n      }\n    }, EXAMPLES.map(function (example, index) {\n      return /*#__PURE__*/_react.default.createElement(_antd.Menu.Item, {\n        key: index,\n        icon: /*#__PURE__*/_react.default.createElement(_icons.BarChartOutlined, null)\n      }, example.name);\n    }));\n\n    return /*#__PURE__*/_react.default.createElement(\"div\", null, /*#__PURE__*/_react.default.createElement(\"h3\", null, \"Scroll to view all\"), /*#__PURE__*/_react.default.createElement(_antd.Dropdown.Button, {\n      overlay: menu\n    }, example.name), /*#__PURE__*/_react.default.createElement(ChartCodeWrapper, {\n      spec: example.spec\n    }), /*#__PURE__*/_react.default.createElement(LinterWrapper, {\n      solverInit: solverInit,\n      aspStr: aspStr,\n      toSolve: function toSolve() {\n        _toSolve(aspStr);\n      },\n      violatedRules: violatedRules\n    }), /*#__PURE__*/_react.default.createElement(\"div\", {\n      style: {\n        marginTop: 32\n      }\n    }, /*#__PURE__*/_react.default.createElement(_antd.Button, {\n      type: \"primary\",\n      disabled: !violatedRules || !violatedRules.length,\n      onClick: async function onClick() {\n        await toFix(example.spec, pickViolatedRuleArray);\n      }\n    }, \"Fix\"), /*#__PURE__*/_react.default.createElement(\"span\", {\n      style: {\n        marginLeft: 16\n      }\n    }, violatedRules && violatedRules.length && optVl.mark ? 'Done.' : fixing ? 'Fixing...' : '')), /*#__PURE__*/_react.default.createElement(ChartCodeWrapper, {\n      spec: optVl\n    }));\n  };\n\n  _reactDom.default.render( /*#__PURE__*/_react.default.createElement(App, null), document.getElementById('container'));\n});"},{"relativePath":"chart-linter/linter/demo/g2plot.jsx","absolutePath":"/Users/pd/Documents/code/github/AVA/packages/ava-site/examples/chart-linter/linter/demo/g2plot.jsx","order":1,"filename":"g2plot.jsx","title":{"en":"Using in G2Plot","zh":"在G2Plot中使用"},"screenshot":"https://gw.alipayobjects.com/zos/antfincdn/dNEGhttBFB/Kapture%2525202021-05-26%252520at%25252023.29.22.gif","new":true,"source":"import React, { useState, useEffect, useRef } from 'react';\nimport ReactDOM from 'react-dom';\nimport { Badge, Popover, Checkbox } from 'antd';\nimport { g2plotRender } from '@antv/chart-advisor';\nimport { getFieldsFromData, vl2asp, Linter, libConfigToSpec } from '@antv/chart-linter';\n\nconst data = [\n  {\n    type: 'furniture',\n    sales: 38,\n  },\n  {\n    type: 'food',\n    sales: 52,\n  },\n  {\n    type: 'fruit',\n    sales: 61,\n  },\n  {\n    type: 'lights',\n    sales: 145,\n  },\n  {\n    type: 'kitchen',\n    sales: 48,\n  },\n  {\n    type: 'garden',\n    sales: 38,\n  },\n  {\n    type: 'drink',\n    sales: 38,\n  },\n  {\n    type: 'pets',\n    sales: 38,\n  },\n];\n\nconst originalConfig = {\n  type: 'Column',\n  configs: {\n    xField: 'type',\n    yField: 'sales',\n    label: {\n      position: 'middle',\n      style: {\n        fill: '#FFFFFF',\n        opacity: 0.6,\n      },\n    },\n    xAxis: {\n      label: {\n        autoHide: true,\n        autoRotate: false,\n      },\n    },\n    yAxis: {\n      minLimit: 20,\n    },\n    meta: {\n      type: {\n        alias: 'category',\n      },\n    },\n  },\n};\n\nconst RuleLibrary = {\n  'bar_without_domain_min_column': {\n    lintText: 'It is not recommended to set  y-axis for bar or column charts',\n    fixText: 'Remove the minimum value config of y-axis',\n  }\n};\n\nconst ActionLibrary = {\n  'bar_without_domain_min_column': (config) => {\n    return {\n      check: {\n        yAxis: {\n          minLimit: undefined,\n        },\n      },\n      undo: {\n        yAxis: {\n          minLimit: config?.yAxis?.minLimit,\n        },\n      },\n    }\n  }\n};\n\nconst App = () => {\n  const canvas = useRef(null);\n  const chart = useRef(null);\n\n  const [rules, setRules] = useState([]);\n  const [config, setConfig] = useState(originalConfig);\n\n\n  useEffect(() => {\n    if (rules.length <= 0) {\n      const initLinter = async () => {\n        const linter = new Linter();\n        const libConfig = {\n          type: 'column',\n          options: {\n            ...config.configs,\n            data,\n          }\n        };\n  \n        const adaptedSpec = libConfigToSpec(libConfig);\n  \n        const transformSpecToAsp = async spec => {\n          const fieldInfos = await getFieldsFromData(spec);\n          return vl2asp(spec, fieldInfos).join('\\n');\n        }\n  \n        const aspStr = adaptedSpec && await transformSpecToAsp(adaptedSpec);\n  \n        linter.init().then(() => {\n          if (aspStr) {\n            const { rules: linterRules } = linter.solve(aspStr, { models: 5 });\n            setRules(linterRules?.[0]?.map(rule => ({\n              id: rule?.id,\n              checked: false,\n            })));\n          }\n        });\n      };\n      initLinter();\n    }\n\n    if (canvas.current) {\n      if (chart.current) {\n        chart.current.update(config.configs);\n      } else {\n         g2plotRender(canvas.current, data, config).then(plot => chart.current = plot);\n      }\n    }\n  }, [config]);\n\n  const checkFix = (e, checkedRuleId) => {\n    const checked = e.target.checked;\n    setRules(rules.map(rule => {\n      if (rule.id === checkedRuleId) {\n        const action = ActionLibrary[checkedRuleId](originalConfig.configs);\n        if (checked) {\n          setConfig({\n            ...config,\n            ...{\n              configs: {\n                ...action.check,\n              },\n            },\n          });\n        } else {\n          setConfig({\n            ...config,\n            ...{\n              configs: {\n                ...action.undo,\n              },\n            },\n          });\n        }\n\n        return {\n          ...rule,\n          checked,\n        };\n      }\n    }))\n  }\n\n  const renderLinter = rules.length > 0 ? (\n    <div>\n      <h3>This chart has the following improvements</h3>\n      <ul>\n        {\n          rules.map(rule => (\n            <li key={rule.id}>\n              <div>{RuleLibrary[rule.id]?.lintText}</div>\n              <div>\n                <Checkbox checked={rule.checked} onChange={e => checkFix(e, rule.id)}>\n                  {RuleLibrary[rule.id]?.fixText}\n                </Checkbox>\n              </div>\n            </li>\n          ))\n        }\n      </ul>\n    </div>\n  ) : null;\n\n  return (\n    <div style={{ display: 'flex' }}>\n      <div ref={canvas} style={{ flex: 8, minHeight: 300 }} />\n      <div style={{ flex: 2 }}>\n        <Popover content={renderLinter} trigger=\"click\">\n          {\n            rules.length > 0 ? <Badge count={rules.length} style={{ backgroundColor: '#faad14', cursor: 'pointer' }} />\n            : <span>ChartLinter Loading...</span>\n          }\n        </Popover>\n      </div>\n    </div>\n  );\n};\n\nReactDOM.render(<App />, document.getElementById('container'));\n","babeledSource":"function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n(function (global, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    define([\"react\", \"react-dom\", \"antd\", \"@antv/chart-advisor\", \"@antv/chart-linter\"], factory);\n  } else if (typeof exports !== \"undefined\") {\n    factory(require(\"react\"), require(\"react-dom\"), require(\"antd\"), require(\"@antv/chart-advisor\"), require(\"@antv/chart-linter\"));\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(global.react, global.reactDom, global.antd, global.chartAdvisor, global.chartLinter);\n    global.g2plot = mod.exports;\n  }\n})(typeof globalThis !== \"undefined\" ? globalThis : typeof self !== \"undefined\" ? self : this, function (_react, _reactDom, _antd, _chartAdvisor, _chartLinter) {\n  \"use strict\";\n\n  _react = _interopRequireWildcard(_react);\n  _reactDom = _interopRequireDefault(_reactDom);\n\n  function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n  function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\n  function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\n  function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\n  function _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\n  function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\n  function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n  function _iterableToArrayLimit(arr, i) { var _i = arr && (typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]); if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\n  function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\n  var data = [{\n    type: 'furniture',\n    sales: 38\n  }, {\n    type: 'food',\n    sales: 52\n  }, {\n    type: 'fruit',\n    sales: 61\n  }, {\n    type: 'lights',\n    sales: 145\n  }, {\n    type: 'kitchen',\n    sales: 48\n  }, {\n    type: 'garden',\n    sales: 38\n  }, {\n    type: 'drink',\n    sales: 38\n  }, {\n    type: 'pets',\n    sales: 38\n  }];\n  var originalConfig = {\n    type: 'Column',\n    configs: {\n      xField: 'type',\n      yField: 'sales',\n      label: {\n        position: 'middle',\n        style: {\n          fill: '#FFFFFF',\n          opacity: 0.6\n        }\n      },\n      xAxis: {\n        label: {\n          autoHide: true,\n          autoRotate: false\n        }\n      },\n      yAxis: {\n        minLimit: 20\n      },\n      meta: {\n        type: {\n          alias: 'category'\n        }\n      }\n    }\n  };\n  var RuleLibrary = {\n    'bar_without_domain_min_column': {\n      lintText: 'It is not recommended to set  y-axis for bar or column charts',\n      fixText: 'Remove the minimum value config of y-axis'\n    }\n  };\n  var ActionLibrary = {\n    'bar_without_domain_min_column': function bar_without_domain_min_column(config) {\n      var _config$yAxis;\n\n      return {\n        check: {\n          yAxis: {\n            minLimit: undefined\n          }\n        },\n        undo: {\n          yAxis: {\n            minLimit: config === null || config === void 0 ? void 0 : (_config$yAxis = config.yAxis) === null || _config$yAxis === void 0 ? void 0 : _config$yAxis.minLimit\n          }\n        }\n      };\n    }\n  };\n\n  var App = function App() {\n    var canvas = (0, _react.useRef)(null);\n    var chart = (0, _react.useRef)(null);\n\n    var _useState = (0, _react.useState)([]),\n        _useState2 = _slicedToArray(_useState, 2),\n        rules = _useState2[0],\n        setRules = _useState2[1];\n\n    var _useState3 = (0, _react.useState)(originalConfig),\n        _useState4 = _slicedToArray(_useState3, 2),\n        config = _useState4[0],\n        setConfig = _useState4[1];\n\n    (0, _react.useEffect)(function () {\n      if (rules.length <= 0) {\n        var initLinter = async function initLinter() {\n          var linter = new _chartLinter.Linter();\n          var libConfig = {\n            type: 'column',\n            options: { ...config.configs,\n              data: data\n            }\n          };\n          var adaptedSpec = (0, _chartLinter.libConfigToSpec)(libConfig);\n\n          var transformSpecToAsp = async function transformSpecToAsp(spec) {\n            var fieldInfos = await (0, _chartLinter.getFieldsFromData)(spec);\n            return (0, _chartLinter.vl2asp)(spec, fieldInfos).join('\\n');\n          };\n\n          var aspStr = adaptedSpec && (await transformSpecToAsp(adaptedSpec));\n          linter.init().then(function () {\n            if (aspStr) {\n              var _linterRules$;\n\n              var _linter$solve = linter.solve(aspStr, {\n                models: 5\n              }),\n                  linterRules = _linter$solve.rules;\n\n              setRules(linterRules === null || linterRules === void 0 ? void 0 : (_linterRules$ = linterRules[0]) === null || _linterRules$ === void 0 ? void 0 : _linterRules$.map(function (rule) {\n                return {\n                  id: rule === null || rule === void 0 ? void 0 : rule.id,\n                  checked: false\n                };\n              }));\n            }\n          });\n        };\n\n        initLinter();\n      }\n\n      if (canvas.current) {\n        if (chart.current) {\n          chart.current.update(config.configs);\n        } else {\n          (0, _chartAdvisor.g2plotRender)(canvas.current, data, config).then(function (plot) {\n            return chart.current = plot;\n          });\n        }\n      }\n    }, [config]);\n\n    var checkFix = function checkFix(e, checkedRuleId) {\n      var checked = e.target.checked;\n      setRules(rules.map(function (rule) {\n        if (rule.id === checkedRuleId) {\n          var action = ActionLibrary[checkedRuleId](originalConfig.configs);\n\n          if (checked) {\n            setConfig({ ...config,\n              ...{\n                configs: { ...action.check\n                }\n              }\n            });\n          } else {\n            setConfig({ ...config,\n              ...{\n                configs: { ...action.undo\n                }\n              }\n            });\n          }\n\n          return { ...rule,\n            checked: checked\n          };\n        }\n      }));\n    };\n\n    var renderLinter = rules.length > 0 ? /*#__PURE__*/_react.default.createElement(\"div\", null, /*#__PURE__*/_react.default.createElement(\"h3\", null, \"This chart has the following improvements\"), /*#__PURE__*/_react.default.createElement(\"ul\", null, rules.map(function (rule) {\n      var _RuleLibrary$rule$id, _RuleLibrary$rule$id2;\n\n      return /*#__PURE__*/_react.default.createElement(\"li\", {\n        key: rule.id\n      }, /*#__PURE__*/_react.default.createElement(\"div\", null, (_RuleLibrary$rule$id = RuleLibrary[rule.id]) === null || _RuleLibrary$rule$id === void 0 ? void 0 : _RuleLibrary$rule$id.lintText), /*#__PURE__*/_react.default.createElement(\"div\", null, /*#__PURE__*/_react.default.createElement(_antd.Checkbox, {\n        checked: rule.checked,\n        onChange: function onChange(e) {\n          return checkFix(e, rule.id);\n        }\n      }, (_RuleLibrary$rule$id2 = RuleLibrary[rule.id]) === null || _RuleLibrary$rule$id2 === void 0 ? void 0 : _RuleLibrary$rule$id2.fixText)));\n    }))) : null;\n    return /*#__PURE__*/_react.default.createElement(\"div\", {\n      style: {\n        display: 'flex'\n      }\n    }, /*#__PURE__*/_react.default.createElement(\"div\", {\n      ref: canvas,\n      style: {\n        flex: 8,\n        minHeight: 300\n      }\n    }), /*#__PURE__*/_react.default.createElement(\"div\", {\n      style: {\n        flex: 2\n      }\n    }, /*#__PURE__*/_react.default.createElement(_antd.Popover, {\n      content: renderLinter,\n      trigger: \"click\"\n    }, rules.length > 0 ? /*#__PURE__*/_react.default.createElement(_antd.Badge, {\n      count: rules.length,\n      style: {\n        backgroundColor: '#faad14',\n        cursor: 'pointer'\n      }\n    }) : /*#__PURE__*/_react.default.createElement(\"span\", null, \"ChartLinter Loading...\"))));\n  };\n\n  _reactDom.default.render( /*#__PURE__*/_react.default.createElement(App, null), document.getElementById('container'));\n});"}],"API":{"node":{"fields":{"slug":"/en/examples/chart-linter/linter/API"},"frontmatter":{"title":"","order":null},"html":"<div><h2 id=\"linter\" style=\"position:relative;\"><a href=\"#linter\" aria-label=\"linter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Linter</h2><style>\n  .doc-md h3 {\n    color: #873bf4;\n    border-bottom: 1px solid #f0f0f0;\n    margin: 1.2em 0 0.4em;\n  }\n\n  .doc-md p {\n    margin: 0.6em 0;\n  }\n\n  .doc-md h4 {\n    border-bottom: 1px solid #f0f0f0;\n  }\n\n  .doc-md h4::before {\n    content: '> ';\n    opacity: 0.5;\n  }\n\n  .doc-md .ant-badge p {\n    line-height: 20px;\n  }\n</style><div class=\"doc-md\"><p>The Linter class in ChartLinter, which is responsible for identifying chart problems, can be used to generate a Linter instance. It provides the function needed for chart optimization.</p><div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Linter <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@antv/chart-linter'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> linter <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Linter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div><p>After the Linter instance is created, the initialization function should be executed. In the initialization process, some modules for chart optimization will be got.</p><div class=\"gatsby-highlight\" data-language=\"sign\"><pre class=\"language-sign\"><code class=\"language-sign\">linter.init();</code></pre></div><p>Then, the Linter instance can receive the chart configuration, and the return result is the list of problems in the chart.</p><div class=\"gatsby-highlight\" data-language=\"sign\"><pre class=\"language-sign\"><code class=\"language-sign\">linter.solve(program: string, options: SolveOptions = {});</code></pre></div></div><h2 id=\"libconfigtospec\" style=\"position:relative;\"><a href=\"#libconfigtospec\" aria-label=\"libconfigtospec permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>libConfigToSpec</h2><style>\n  .doc-md h3 {\n    color: #873bf4;\n    border-bottom: 1px solid #f0f0f0;\n    margin: 1.2em 0 0.4em;\n  }\n\n  .doc-md p {\n    margin: 0.6em 0;\n  }\n\n  .doc-md h4 {\n    border-bottom: 1px solid #f0f0f0;\n  }\n\n  .doc-md h4::before {\n    content: '> ';\n    opacity: 0.5;\n  }\n\n  .doc-md .ant-badge p {\n    line-height: 20px;\n  }\n</style><div class='doc-md'><div class=\"gatsby-highlight\" data-language=\"sign\"><pre class=\"language-sign\"><code class=\"language-sign\">libConfigToSpec(libConfig: G2PlotConfig, libName?: &#39;G2Plot&#39;)</code></pre></div><h3 id=\"arguments\" style=\"position:relative;\"><a href=\"#arguments\" aria-label=\"arguments permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Arguments</h3><ul>\n<li>\n<p><strong>libConfig</strong> * Chart Configuration</p>\n<ul>\n<li><em>required</em></li>\n<li><code class=\"language-text\">type</code>: G2PlotConfig</li>\n</ul>\n</li>\n<li>\n<p><strong>libraryName</strong> * Library Name</p>\n<ul>\n<li><em>optional</em></li>\n<li><code class=\"language-text\">type</code>: <code class=\"language-text\">&#39;G2Plot&#39;</code></li>\n<li><code class=\"language-text\">default</code>: <code class=\"language-text\">&#39;G2Plot&#39;</code></li>\n</ul>\n</li>\n</ul><h3 id=\"returns\" style=\"position:relative;\"><a href=\"#returns\" aria-label=\"returns permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Returns</h3><p><em><code class=\"language-text\">Specification | null</code></em></p><p>The specification transformed from the configuration of library.</p><div class=\"gatsby-highlight\" data-language=\"sign\"><pre class=\"language-sign\"><code class=\"language-sign\">interface G2PlotConfig {\n  type: G2PlotChartType;\n  options: G2PlotOptions;\n}</code></pre></div><ul>\n<li>type <code class=\"language-text\">G2PlotChartType</code> <code class=\"language-text\">&#39;line&#39; | &#39;column&#39; | &#39;bar&#39; | &#39;histogram&#39;</code></li>\n<li>options <code class=\"language-text\">G2PlotOptions</code> <code class=\"language-text\">&#39;LineOptions&#39; | &#39;ColumnOptions&#39; | &#39;BarOptions&#39; | &#39;HistogramOptions&#39;</code></li>\n</ul></div><h2 id=\"getfieldsfromdata\" style=\"position:relative;\"><a href=\"#getfieldsfromdata\" aria-label=\"getfieldsfromdata permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>getFieldsFromData</h2><style>\n  .doc-md h3 {\n    color: #873bf4;\n    border-bottom: 1px solid #f0f0f0;\n    margin: 1.2em 0 0.4em;\n  }\n\n  .doc-md p {\n    margin: 0.6em 0;\n  }\n\n  .doc-md h4 {\n    border-bottom: 1px solid #f0f0f0;\n  }\n\n  .doc-md h4::before {\n    content: '> ';\n    opacity: 0.5;\n  }\n\n  .doc-md .ant-badge p {\n    line-height: 20px;\n  }\n</style><div class='doc-md'><div class=\"gatsby-highlight\" data-language=\"sign\"><pre class=\"language-sign\"><code class=\"language-sign\">getFieldsFromData(spec: VegaLite): Promise&lt;Field[]&gt;</code></pre></div><h3 id=\"arguments-1\" style=\"position:relative;\"><a href=\"#arguments-1\" aria-label=\"arguments 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Arguments</h3><ul>\n<li>\n<p><strong>spec</strong> * Specification</p>\n<ul>\n<li><em>required</em></li>\n<li><code class=\"language-text\">type</code>: VegaLite</li>\n</ul>\n</li>\n</ul><h3 id=\"returns-1\" style=\"position:relative;\"><a href=\"#returns-1\" aria-label=\"returns 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Returns</h3><p><em><code class=\"language-text\">Promise&lt;Field[]&gt;</code></em></p><p>Get all field from data and identify their types used in specification.</p></div><h2 id=\"vl2asp\" style=\"position:relative;\"><a href=\"#vl2asp\" aria-label=\"vl2asp permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>vl2asp</h2><style>\n  .doc-md h3 {\n    color: #873bf4;\n    border-bottom: 1px solid #f0f0f0;\n    margin: 1.2em 0 0.4em;\n  }\n\n  .doc-md p {\n    margin: 0.6em 0;\n  }\n\n  .doc-md h4 {\n    border-bottom: 1px solid #f0f0f0;\n  }\n\n  .doc-md h4::before {\n    content: '> ';\n    opacity: 0.5;\n  }\n\n  .doc-md .ant-badge p {\n    line-height: 20px;\n  }\n</style><div class='doc-md'><div class=\"gatsby-highlight\" data-language=\"sign\"><pre class=\"language-sign\"><code class=\"language-sign\">vl2asp(spec: VegaLite, fieldInfos: Field[]): string[]</code></pre></div><h3 id=\"arguments-2\" style=\"position:relative;\"><a href=\"#arguments-2\" aria-label=\"arguments 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Arguments</h3><ul>\n<li>\n<p><strong>spec</strong> * Specification</p>\n<ul>\n<li><em>required</em></li>\n<li><code class=\"language-text\">type</code>: VegaLite</li>\n</ul>\n</li>\n<li>\n<p><strong>fieldInfos</strong> * Field Information</p>\n<ul>\n<li><em>required</em></li>\n<li><code class=\"language-text\">type</code>: <code class=\"language-text\">&#39;Field[]&#39;</code></li>\n</ul>\n</li>\n</ul><h3 id=\"returns-2\" style=\"position:relative;\"><a href=\"#returns-2\" aria-label=\"returns 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Returns</h3><p><em><code class=\"language-text\">string[]</code></em></p></div></div>"}}},"description":""}},"staticQueryHashes":["1976131296","2020267008","2421159097","3000541721","3000541721"]}